[gcode_macro CANCEL_PRINT]
rename_existing: BASE_CANCEL_PRINT
gcode:
    TURN_OFF_HEATERS
    SET_STEPPER_ENABLE STEPPER=extruder ENABLE=0
    SET_STEPPER_ENABLE STEPPER=stepper_x ENABLE=0
    SET_STEPPER_ENABLE STEPPER=stepper_y ENABLE=0
    SET_STEPPER_ENABLE STEPPER=stepper_z ENABLE=0
    BASE_CANCEL_PRINT



[gcode_macro RESUME_MACRO]
gcode:
   M117 RESUMING...
   G92 E0
   G1 E20 F100
   G92 E0
   G1 E80 F500
   G92 E0
   M117 Printing...
   RESUME
   RESTORE_GCODE_STATE NAME=SAVESTATE MOVE=1


[pause_resume]
recover_velocity: 50.0

[gcode_macro M600]
gcode:
    SAVE_GCODE_STATE NAME=M600_state
    PAUSE
    G91
    G1 E-.8 F2700
    G1 Z10
    G90
    G1 X50 Y0 F3000
    G91
    G1 E-50 F1000
    RESTORE_GCODE_STATE NAME=M600_state


[gcode_macro filament_out_190]
gcode:
    filament_out EXTRUDER_TEMP=190

[gcode_macro filament_out_220]
gcode:
    filament_out EXTRUDER_TEMP=220

[gcode_macro filament_out]
gcode:
    SAVE_GCODE_STATE NAME=__filament__load
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|float %}
    {% if printer.extruder.temperature < EXTRUDER_TEMP %}
        M109 S{EXTRUDER_TEMP}
    {% endif %}
    M83
    G1 E-80 F500
    RESTORE_GCODE_STATE NAME=__filament__load

[gcode_macro filament_load_200]
gcode:
    filament_load EXTRUDER_TEMP=200

[gcode_macro filament_load_230]
gcode:
    filament_load EXTRUDER_TEMP=230

[gcode_macro filament_load]
gcode:
    SAVE_GCODE_STATE NAME=__filament__load
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|float %}
    {% if printer.extruder.temperature < EXTRUDER_TEMP %}
        M109 S{EXTRUDER_TEMP}
    {% endif %}
    M83
    G1 E50 F960
    G1 E23 F240
    G1 E-5 F240
    RESTORE_GCODE_STATE NAME=__filament__load

[gcode_macro flex_filament_load_220]
gcode:
    SAVE_GCODE_STATE NAME=__filament__load
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(220)|float %}
    {% if printer.extruder.temperature < EXTRUDER_TEMP %}
        M109 S{EXTRUDER_TEMP}
    {% endif %}
    M83
    G1 E50 F80
    G1 E23 F80
    G1 E-5 F80
    RESTORE_GCODE_STATE NAME=__filament__load

[gcode_macro Lift_for_Cleaning]
gcode:
    {% if printer.toolhead.position.z < 130 %}
        G28
        G91
        G0 Z130 F5000
        G90
    {% endif %}

    SET_STEPPER_ENABLE STEPPER=extruder ENABLE=0
    SET_STEPPER_ENABLE STEPPER=stepper_x ENABLE=0
    SET_STEPPER_ENABLE STEPPER=stepper_y ENABLE=0
    SET_STEPPER_ENABLE STEPPER=stepper_z ENABLE=0
